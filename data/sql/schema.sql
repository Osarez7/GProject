CREATE TABLE evento (idevento BIGINT AUTO_INCREMENT, fechaevento DATETIME NOT NULL, nombreevento VARCHAR(50) NOT NULL, descevento VARCHAR(200) NOT NULL, proyecto_idproyecto BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX proyecto_idproyecto_idx (proyecto_idproyecto), PRIMARY KEY(idevento)) ENGINE = INNODB;
CREATE TABLE grupo (idgrupo BIGINT AUTO_INCREMENT, nombregrupo VARCHAR(50) NOT NULL, descgrupo VARCHAR(200) NOT NULL, PRIMARY KEY(idgrupo)) ENGINE = INNODB;
CREATE TABLE grupo__usuario (usuario_idusuario BIGINT, grupo_idgrupo BIGINT, PRIMARY KEY(usuario_idusuario, grupo_idgrupo)) ENGINE = INNODB;
CREATE TABLE otra_tabla (idotra BIGINT, nombreotra VARCHAR(20) NOT NULL, PRIMARY KEY(idotra)) ENGINE = INNODB;
CREATE TABLE prioridad (idprioridad BIGINT AUTO_INCREMENT, nombreprioridad VARCHAR(50) NOT NULL, PRIMARY KEY(idprioridad)) ENGINE = INNODB;
CREATE TABLE proyecto (idproyecto BIGINT AUTO_INCREMENT, nombre VARCHAR(50) NOT NULL, tiempo_estimado BIGINT NOT NULL, fecha_cracion DATETIME NOT NULL, fecha_actualizacion DATETIME NOT NULL, descproyecto FLOAT(18, 2) NOT NULL, status_idstatus BIGINT NOT NULL, prioridad_idprioridad BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX status_idstatus_idx (status_idstatus), INDEX prioridad_idprioridad_idx (prioridad_idprioridad), PRIMARY KEY(idproyecto)) ENGINE = INNODB;
CREATE TABLE registro__estado__proyecto (idregistroproyecto BIGINT AUTO_INCREMENT, fecha_cambio_estado DATETIME NOT NULL, status_idstatus BIGINT NOT NULL, proyecto_idproyecto BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX status_idstatus_idx (status_idstatus), INDEX proyecto_idproyecto_idx (proyecto_idproyecto), PRIMARY KEY(idregistroproyecto)) ENGINE = INNODB;
CREATE TABLE registro__estado__tarea (idregistrotarea BIGINT AUTO_INCREMENT, fecha_cambio_estado DATETIME NOT NULL, status_idstatus BIGINT NOT NULL, tarea_idtarea BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX status_idstatus_idx (status_idstatus), INDEX tarea_idtarea_idx (tarea_idtarea), PRIMARY KEY(idregistrotarea)) ENGINE = INNODB;
CREATE TABLE relacion (idrelacion BIGINT AUTO_INCREMENT, nombrerelaion VARCHAR(50) NOT NULL, PRIMARY KEY(idrelacion)) ENGINE = INNODB;
CREATE TABLE relacion__tarea (idrelaciontarea BIGINT AUTO_INCREMENT, fecha_relacion DATETIME NOT NULL, tareaorigen_idtarea BIGINT NOT NULL, tareadestino_idtarea BIGINT NOT NULL, relacion_idrelacion BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX tareadestino_idtarea_idx (tareadestino_idtarea), INDEX relacion_idrelacion_idx (relacion_idrelacion), PRIMARY KEY(idrelaciontarea)) ENGINE = INNODB;
CREATE TABLE status (idstatus BIGINT AUTO_INCREMENT, nombrestatus VARCHAR(50) NOT NULL, PRIMARY KEY(idstatus)) ENGINE = INNODB;
CREATE TABLE tarea (idtarea BIGINT AUTO_INCREMENT, tar_nombre VARCHAR(50) NOT NULL, tar_estado VARCHAR(50) NOT NULL, tar_fecha_creacion DATETIME NOT NULL, tar_fecha_actulizacion DATETIME NOT NULL, status_idstatus BIGINT NOT NULL, prioridad_idprioridad BIGINT NOT NULL, grupo_idgrupo BIGINT NOT NULL, proyecto_idproyecto BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX status_idstatus_idx (status_idstatus), INDEX prioridad_idprioridad_idx (prioridad_idprioridad), INDEX proyecto_idproyecto_idx (proyecto_idproyecto), INDEX grupo_idgrupo_idx (grupo_idgrupo), PRIMARY KEY(idtarea)) ENGINE = INNODB;
CREATE TABLE tipo_usuario (idtipousuario BIGINT AUTO_INCREMENT, tipo_nombre VARCHAR(50) NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(idtipousuario)) ENGINE = INNODB;
CREATE TABLE usuario (idusuario BIGINT AUTO_INCREMENT, tipo_idtipousuario BIGINT NOT NULL, usr_nombre VARCHAR(50) NOT NULL, usr_apellido1 VARCHAR(20) NOT NULL, usr_apellido2 VARCHAR(20) NOT NULL, email VARCHAR(100) NOT NULL, usr_nick VARCHAR(20) NOT NULL UNIQUE, password VARCHAR(32) NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX tipo_idtipousuario_idx (tipo_idtipousuario), PRIMARY KEY(idusuario)) ENGINE = INNODB;
CREATE TABLE usuario__tarea (usuario_id BIGINT, tarea_id BIGINT, PRIMARY KEY(usuario_id, tarea_id)) ENGINE = INNODB;
ALTER TABLE evento ADD CONSTRAINT evento_proyecto_idproyecto_proyecto_idproyecto FOREIGN KEY (proyecto_idproyecto) REFERENCES proyecto(idproyecto) ON DELETE CASCADE;
ALTER TABLE grupo__usuario ADD CONSTRAINT grupo__usuario_usuario_idusuario_usuario_idusuario FOREIGN KEY (usuario_idusuario) REFERENCES usuario(idusuario) ON DELETE CASCADE;
ALTER TABLE grupo__usuario ADD CONSTRAINT grupo__usuario_grupo_idgrupo_grupo_idgrupo FOREIGN KEY (grupo_idgrupo) REFERENCES grupo(idgrupo) ON DELETE CASCADE;
ALTER TABLE proyecto ADD CONSTRAINT proyecto_status_idstatus_status_idstatus FOREIGN KEY (status_idstatus) REFERENCES status(idstatus) ON DELETE CASCADE;
ALTER TABLE proyecto ADD CONSTRAINT proyecto_prioridad_idprioridad_prioridad_idprioridad FOREIGN KEY (prioridad_idprioridad) REFERENCES prioridad(idprioridad) ON DELETE CASCADE;
ALTER TABLE registro__estado__proyecto ADD CONSTRAINT rppi FOREIGN KEY (proyecto_idproyecto) REFERENCES proyecto(idproyecto) ON DELETE CASCADE;
ALTER TABLE registro__estado__proyecto ADD CONSTRAINT registro__estado__proyecto_status_idstatus_status_idstatus FOREIGN KEY (status_idstatus) REFERENCES status(idstatus) ON DELETE CASCADE;
ALTER TABLE registro__estado__tarea ADD CONSTRAINT registro__estado__tarea_tarea_idtarea_tarea_idtarea FOREIGN KEY (tarea_idtarea) REFERENCES tarea(idtarea) ON DELETE CASCADE;
ALTER TABLE registro__estado__tarea ADD CONSTRAINT registro__estado__tarea_status_idstatus_status_idstatus FOREIGN KEY (status_idstatus) REFERENCES status(idstatus) ON DELETE CASCADE;
ALTER TABLE relacion__tarea ADD CONSTRAINT relacion__tarea_tareadestino_idtarea_tarea_idtarea FOREIGN KEY (tareadestino_idtarea) REFERENCES tarea(idtarea) ON DELETE CASCADE;
ALTER TABLE relacion__tarea ADD CONSTRAINT relacion__tarea_relacion_idrelacion_relacion_idrelacion FOREIGN KEY (relacion_idrelacion) REFERENCES relacion(idrelacion) ON DELETE CASCADE;
ALTER TABLE tarea ADD CONSTRAINT tarea_status_idstatus_status_idstatus FOREIGN KEY (status_idstatus) REFERENCES status(idstatus) ON DELETE CASCADE;
ALTER TABLE tarea ADD CONSTRAINT tarea_proyecto_idproyecto_proyecto_idproyecto FOREIGN KEY (proyecto_idproyecto) REFERENCES proyecto(idproyecto) ON DELETE CASCADE;
ALTER TABLE tarea ADD CONSTRAINT tarea_prioridad_idprioridad_prioridad_idprioridad FOREIGN KEY (prioridad_idprioridad) REFERENCES prioridad(idprioridad) ON DELETE CASCADE;
ALTER TABLE tarea ADD CONSTRAINT tarea_grupo_idgrupo_grupo_idgrupo FOREIGN KEY (grupo_idgrupo) REFERENCES grupo(idgrupo) ON DELETE CASCADE;
ALTER TABLE usuario ADD CONSTRAINT usuario_tipo_idtipousuario_tipo_usuario_idtipousuario FOREIGN KEY (tipo_idtipousuario) REFERENCES tipo_usuario(idtipousuario) ON DELETE CASCADE;
ALTER TABLE usuario__tarea ADD CONSTRAINT usuario__tarea_usuario_id_usuario_idusuario FOREIGN KEY (usuario_id) REFERENCES usuario(idusuario) ON DELETE CASCADE;
ALTER TABLE usuario__tarea ADD CONSTRAINT usuario__tarea_tarea_id_tarea_idtarea FOREIGN KEY (tarea_id) REFERENCES tarea(idtarea) ON DELETE CASCADE;
