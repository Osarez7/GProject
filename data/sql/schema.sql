CREATE TABLE evento (id BIGINT AUTO_INCREMENT, fechaevento DATETIME NOT NULL, nombreevento VARCHAR(50) NOT NULL, descevento VARCHAR(200) NOT NULL, proyecto_idproyecto BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX proyecto_idproyecto_idx (proyecto_idproyecto), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE grupo (id BIGINT AUTO_INCREMENT, nombregrupo VARCHAR(50) NOT NULL, descgrupo VARCHAR(200) NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE grupo__usuario (id BIGINT AUTO_INCREMENT, usuario_idusuario BIGINT NOT NULL, grupo_idgrupo BIGINT NOT NULL, INDEX usuario_idusuario_idx (usuario_idusuario), INDEX grupo_idgrupo_idx (grupo_idgrupo), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE prioridad (id BIGINT AUTO_INCREMENT, nombreprioridad VARCHAR(50) NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE proyecto (id BIGINT AUTO_INCREMENT, nombre VARCHAR(50) NOT NULL, tiempo_estimado BIGINT NOT NULL, fecha_cracion DATETIME NOT NULL, fecha_actualizacion DATETIME NOT NULL, descproyecto FLOAT(18, 2) NOT NULL, idstatus BIGINT NOT NULL, idprioridad BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX idstatus_idx (idstatus), INDEX idprioridad_idx (idprioridad), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE registro__estado__proyecto (id BIGINT AUTO_INCREMENT, fecha_cambio_estado DATETIME NOT NULL, status_idstatus BIGINT NOT NULL, proyecto_idproyecto BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX status_idstatus_idx (status_idstatus), INDEX proyecto_idproyecto_idx (proyecto_idproyecto), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE registro__estado__tarea (id BIGINT AUTO_INCREMENT, fecha_cambio_estado DATETIME NOT NULL, status_idstatus BIGINT NOT NULL, tarea_idtarea BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX status_idstatus_idx (status_idstatus), INDEX tarea_idtarea_idx (tarea_idtarea), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE relacion (id BIGINT AUTO_INCREMENT, nombrerelaion VARCHAR(50) NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE relacion__tarea (id BIGINT AUTO_INCREMENT, fecha_relacion DATETIME NOT NULL, tareaorigen_idtarea BIGINT NOT NULL, tareadestino_idtarea BIGINT NOT NULL, relacion_idrelacion BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX tareadestino_idtarea_idx (tareadestino_idtarea), INDEX relacion_idrelacion_idx (relacion_idrelacion), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE status (id BIGINT AUTO_INCREMENT, nombrestatus VARCHAR(50) NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE tarea (id BIGINT AUTO_INCREMENT, tar_nombre VARCHAR(50) NOT NULL, tar_estado VARCHAR(50) NOT NULL, tar_fecha_creacion DATETIME NOT NULL, tar_fecha_actulizacion DATETIME NOT NULL, idstatus BIGINT NOT NULL, idprioridad BIGINT NOT NULL, idgrupo BIGINT NOT NULL, idproyecto BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX idstatus_idx (idstatus), INDEX idprioridad_idx (idprioridad), INDEX idproyecto_idx (idproyecto), INDEX idgrupo_idx (idgrupo), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE tipo_usuario (id BIGINT AUTO_INCREMENT, tipo_nombre VARCHAR(50) NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE usuario (id BIGINT AUTO_INCREMENT, tipo_id BIGINT NOT NULL, usr_nombre VARCHAR(50) NOT NULL, usr_apellido1 VARCHAR(20) NOT NULL, usr_apellido2 VARCHAR(20) NOT NULL, email VARCHAR(100) NOT NULL, usr_nick VARCHAR(20) NOT NULL UNIQUE, password VARCHAR(32) NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX tipo_id_idx (tipo_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE usuario__tarea (id BIGINT AUTO_INCREMENT, usuario_id BIGINT NOT NULL, tarea_id BIGINT NOT NULL, INDEX usuario_id_idx (usuario_id), INDEX tarea_id_idx (tarea_id), PRIMARY KEY(id)) ENGINE = INNODB;
ALTER TABLE evento ADD CONSTRAINT evento_proyecto_idproyecto_proyecto_id FOREIGN KEY (proyecto_idproyecto) REFERENCES proyecto(id) ON DELETE CASCADE;
ALTER TABLE grupo__usuario ADD CONSTRAINT grupo__usuario_usuario_idusuario_usuario_id FOREIGN KEY (usuario_idusuario) REFERENCES usuario(id) ON DELETE CASCADE;
ALTER TABLE grupo__usuario ADD CONSTRAINT grupo__usuario_grupo_idgrupo_tarea_id FOREIGN KEY (grupo_idgrupo) REFERENCES tarea(id) ON DELETE CASCADE;
ALTER TABLE proyecto ADD CONSTRAINT proyecto_idstatus_status_id FOREIGN KEY (idstatus) REFERENCES status(id) ON DELETE CASCADE;
ALTER TABLE proyecto ADD CONSTRAINT proyecto_idprioridad_prioridad_id FOREIGN KEY (idprioridad) REFERENCES prioridad(id) ON DELETE CASCADE;
ALTER TABLE registro__estado__proyecto ADD CONSTRAINT registro__estado__proyecto_status_idstatus_status_id FOREIGN KEY (status_idstatus) REFERENCES status(id) ON DELETE CASCADE;
ALTER TABLE registro__estado__proyecto ADD CONSTRAINT registro__estado__proyecto_proyecto_idproyecto_proyecto_id FOREIGN KEY (proyecto_idproyecto) REFERENCES proyecto(id) ON DELETE CASCADE;
ALTER TABLE registro__estado__tarea ADD CONSTRAINT registro__estado__tarea_tarea_idtarea_tarea_id FOREIGN KEY (tarea_idtarea) REFERENCES tarea(id) ON DELETE CASCADE;
ALTER TABLE registro__estado__tarea ADD CONSTRAINT registro__estado__tarea_status_idstatus_status_id FOREIGN KEY (status_idstatus) REFERENCES status(id) ON DELETE CASCADE;
ALTER TABLE relacion__tarea ADD CONSTRAINT relacion__tarea_tareadestino_idtarea_tarea_id FOREIGN KEY (tareadestino_idtarea) REFERENCES tarea(id) ON DELETE CASCADE;
ALTER TABLE relacion__tarea ADD CONSTRAINT relacion__tarea_relacion_idrelacion_relacion_id FOREIGN KEY (relacion_idrelacion) REFERENCES relacion(id) ON DELETE CASCADE;
ALTER TABLE tarea ADD CONSTRAINT tarea_idstatus_status_id FOREIGN KEY (idstatus) REFERENCES status(id) ON DELETE CASCADE;
ALTER TABLE tarea ADD CONSTRAINT tarea_idproyecto_proyecto_id FOREIGN KEY (idproyecto) REFERENCES proyecto(id) ON DELETE CASCADE;
ALTER TABLE tarea ADD CONSTRAINT tarea_idprioridad_prioridad_id FOREIGN KEY (idprioridad) REFERENCES prioridad(id) ON DELETE CASCADE;
ALTER TABLE tarea ADD CONSTRAINT tarea_idgrupo_grupo_id FOREIGN KEY (idgrupo) REFERENCES grupo(id) ON DELETE CASCADE;
ALTER TABLE usuario ADD CONSTRAINT usuario_tipo_id_tipo_usuario_id FOREIGN KEY (tipo_id) REFERENCES tipo_usuario(id) ON DELETE CASCADE;
ALTER TABLE usuario__tarea ADD CONSTRAINT usuario__tarea_usuario_id_usuario_id FOREIGN KEY (usuario_id) REFERENCES usuario(id) ON DELETE CASCADE;
ALTER TABLE usuario__tarea ADD CONSTRAINT usuario__tarea_tarea_id_tarea_id FOREIGN KEY (tarea_id) REFERENCES tarea(id) ON DELETE CASCADE;
